{{ block "content" . }}
<div class="breadcrumbs text-sm mb-4">
  <ul>
    <li><a href="/">Home</a></li>
    <li>Help</li>
  </ul>
</div>

<div class="prose max-w-none">
  {{.HTMLContent}}
</div>

{{if .Tasks}}
<div class="mt-8">
  <h2 class="text-2xl font-bold mb-6">Annotation Phases</h2>

  {{range $index, $task := .Tasks}}
  <div class="mb-6">
    <div class="card bg-base-200 shadow-xl">
      <div class="card-body">
        <h2 class="card-title">
          {{$task.ShortName}}
        </h2>
        <p class="text-sm">{{$task.Name}}</p>

        <div class="mt-3">
          <div class="flex justify-between text-xs mb-1">
            <span class="font-semibold">Progress</span>
            <span>{{$task.CompletedCount}}/{{$task.TotalCount}}</span>
          </div>
          {{if gt $task.TotalCount 0}}
          <progress class="progress progress-primary w-full" value="{{$task.CompletedCount}}" max="{{$task.TotalCount}}"></progress>
          {{else}}
          <progress class="progress progress-primary w-full" value="0" max="100"></progress>
          {{end}}
        </div>

        {{if $task.If}}
        <div class="mt-2">
          <span class="text-xs font-semibold opacity-70">Dependencies:</span>
          <div class="flex flex-wrap gap-1 mt-1">
            {{range $depTask, $depValue := $task.If}}
            <div class="badge badge-outline badge-sm">{{$depTask}}: {{$depValue}}</div>
            {{end}}
          </div>
        </div>
        {{end}}

        <div class="card-actions justify-end mt-2">
          <a href="/help/{{$task.ID}}" class="btn btn-sm btn-primary">View Details</a>
          {{if gt $task.AvailableCount 0}}
          <a href="/annotate?task={{$task.ID}}" class="btn btn-sm btn-accent">Annotate</a>
          {{end}}
        </div>
      </div>
    </div>

    {{if ne $index (sub (len $.Tasks) 1)}}
    <div class="flex justify-center my-4">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
      </svg>
    </div>
    {{end}}
  </div>
  {{end}}
</div>
{{end}}
{{ end }}